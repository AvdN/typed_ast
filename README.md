# Typed AST Module
This module is a fork of the CPython 2.7 and 3.5 `ast` modules with the ability
to parse [PEP 484](https://www.python.org/dev/peps/pep-0484/) type comments.
The primary goals of this module are correctness and speed.  This project is
still a work in progress, but is being actively developed.

These extension modules are intended to run on Python 3.

### Current Caveats for Use
- This project currently works on Python 3.3 - 3.5.  Python 3.2 is likely to be
  supported, depending on difficulty.  There are currently no plans to run on
  Python 2.7.
- Type comments in invalid locations produce syntax errors.

## Development Notes
### General Notes
- token names in `Python.asdl` need to match token names both in `tokenizer.c`
  AND in `pgen`'s copy of `tokenizer.c`.

### Rebuilding Autogenerated Files
- After changing `Parser/Python.asdl`, you must run:
 - `python3 Parser/asdl_c.py -h Include/ Parser/Python.asdl`
 - `python3 Parser/asdl_c.py -c Python/ Parser/Python.asdl`
- After changing `Grammar/Grammar`, you must run:
  - `pgen Grammar/Grammar Include/graminit.h Python/graminit.c`
- To get a working `pgen` binary: (this is hacky and will be changed)
 - get a clean copy of Python 3.5.1
 - overwrite `Include/token.h`, `Include/compile.h`, and `Parser/tokenizer.c`
  - (or instead of copying Parser/tokenizer.h just modify _PyParser_TokenNames at the top and tokenization to RARROW)
 with the versions from typed\_ast
 - In the Python directory, run: `./configure && make`
 - `Parser/pgen` (in the Python directory) can now be used to regenerate
 typed\_ast's graminit files.

### TODO
- [x] stop aliasing the official Python headers
- [x] ensure we're not using duplicate versions of important standard library
  functions (like object creation)
- [x] hide most global symbols from being exported to prevent conflicts with other
  libraries -- *changed to a unique prefix*
- [x] allow type ignores to be followed by a comment
- [ ] prevent type comments in incorrect locations from causing syntax errors
- [ ] find a better way to compile pgen
- [x] parse Python 2.7 ASTs
- [ ] ast35: ensure compatibility with older Python versions
 - [x] Python 3.4 (*works on 3.4.4*)
 - [x] Python 3.3 (*works on 3.3.6*)
 - [ ] Python 3.2
- [ ] ast27: ensure compatibility with older Python versions
 - [ ] Python 3.4
 - [ ] Python 3.3
 - [ ] Python 3.2
[ ] refactor out shared code
	[ ] common functions in typed_ast.c
	[ ] type_ignore array resizing functions in parsetok.c
	[ ] type comment parsing code in tokenizer.c
	[ ] func_type_input parsing in ast.c
